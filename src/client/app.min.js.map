{"version":3,"sources":["api.js","app.js","controller/cla.js","controller/home.js","controller/my-cla.js","controller/settings.js","modals/addScope.js","modals/badge.js","modals/claView.js","modals/confirm.js","modals/error.js","modals/info.js","modals/link.js","modals/report.js","modals/upload.js","modals/versionView.js","services/utils.js"],"names":["ResultSet","this","loaded","loading","module","angular","filters","provider","Config","$http","get","done","success","data","status","$get","element","document","ready","bootstrap","config","$stateProvider","$urlRouterProvider","$locationProvider","state","url","templateUrl","controller","params","user","owner","repo","gist","abstract","template","otherwise","html5Mode","enabled","requireBase","run","$rootScope","$state","$stateParams","$config","gacode","ga","prototype","set","error","value","affix","Array","concat","factory","$q","call","m","functn","callback","now","Date","post","res","JSON","parse","ex","user_token","deferred","defer","header","Accept","Authorization","headers","resolve","err","reject","promise","$RAW","$log","debug","parse_link_header","length","Error","parts","split","links","forEach","p","section","replace","trim","name","exec","type","args","meta","link","hasMore","next","getMore","arg","page","o","obj","fun","wrap","$HUB","$RPC","$window","$scope","$RPCService","$HUBService","$sce","$timeout","utils","getUserEmail","key","some","email","customValues","primary","getGithubValues","hasCustomFields","signed","customKeys","githubKey","customFields","getSignedValues","custom_fields","isSharedSignature","cla","getCLA","getGistContent","linkedItem","repoId","orgId","then","gistContent","trustAsHtml","claText","text","noLinkedItemError","message","checkCLA","redirect","pullRequest","location","href","agree","stringify","acceptUrl","signIn","claPromise","userPromise","admin","scopes","indexOf","repoPromise","isValid","isNotEmpty","typeIsValid","field","enum","valid","required","showSharedGistMsg","sharedGist","all","signedPromise","directive","scope","description","logged","min","max","title","isInArray","item","items","check","full_name","login","org","deleteFromArray","array","i","splice","$document","$modal","$location","active","claRepos","claOrgs","defaultClas","errorMsg","gists","nextstep","step1","openSettings","orgs","query","repos","reposAndOrgs","selected","selectedIndex","users","isLoading","logAdminIn","mixOrgData","claOrg","id","avatar_url","getLinkedOrgs","push","mixRepoData","claRepo","fork","getLinkedRepos","repoSet","getRepos","per_page","affiliation","permissions","getGists","getDefaultClaFiles","gistFile","getGistAttribute","html_url","getOrgs","org_admin","showErrorMessage","linkSuccess","open","windowClass","result","newLink","confirmAdd","linkStatus","confirmRemove","remove","info","addScope","gistShareInfo","count","numberClas","numberRepos","numberStars","$broadcast","clear","$event","stopPropagation","undefined","match","isRepo","addWebhook","removeWebhook","linkCla","linkItem","linkedArray","promise1","errmsg","promise2","linkRepo","newClaRepo","linkOrg","newClaOrg","excludePattern","api","removeArgs","isActive","viewLocation","groupDefaultCla","found","defCla","groupOrgs","iconSrc","time","children","start","filter","arr","notMatched","$filter","getLinkedGist","signedCLA","newCLA","signedCLAs","orderBy","getSignedCLA","getGist","getVersionStatus","gist_url","gist_version","gistObj","getGistName","order","predicate","reverse","getClaView","getGistVersion","getVersionView","noCLA","showCLA","stat","gistArgs","history","gistIndex","version","gistUrlIsValid","signatures","contributors","webhook","csvHeader","open_error","getSignatures","cb","getCustomFields","getWebhook","getContributors","keys","signature","contributor","user_name","repo_owner","repo_name","gist_name","signed_at","created_at","org_cla","linked","fileName","validateLinkedItem","promises","isLinkActive","renderHtml","html_code","report","getReport","validateRepoPr","validatePR","popoverIsOpen","validateOrgPr","recheck","upload","getBadge","transclude","documentClickHandler","event","target","find","$apply","on","$on","off","$modalInstance","origin","cancel","dismiss","ok","close","badgeUrl","linkUrl","types","selectedType","restrict","ngClipboardSuccess","ngClipboardError","clipboard","Clipboard","e","claObj","modalInstance","raw","attrs","$watch","clacontent","content","linkIcons","getElementsByClassName","index","hasOwnProperty","removeClass","claItem","newContributors","selectedVersion","json","file","Papa","complete","fileModel","elem","bind","change","reader","FileReader","onload","load","readAsText","files","console","log","openNewCla","openRevision","reservedGistFileNames","attribute","attr","Object","metaString"],"mappings":"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","file":"app.min.js","sourcesContent":["'use strict';\n\n// *****************************************************\n// API\n// *****************************************************\n\nfunction ResultSet() {\n\n    this.loaded = false;\n    this.loading = true;\n\n}\n\nResultSet.prototype.set = function(error, value) {\n\n    this.loaded = true;\n    this.loading = false;\n\n    this.error = error;\n    this.affix = value;\n    this.value = (this.value instanceof Array && value instanceof Array) ? this.value.concat(value) : value;\n\n};\n\n\nmodule.factory('$RAW', ['$q', '$http',\n    function($q, $http) {\n        return {\n            call: function(m, functn, data, callback) {\n                var now = new Date();\n                return $http.post('/api/' + m + '/' + functn, data)\n                    .success(function(res) {\n                        // parse result (again)\n                        try {\n                            res = JSON.parse(res);\n                        } catch (ex) {\n                            // doNothing\n                        }\n                        // yield result\n                        callback(null, res, new Date() - now);\n                    })\n                    .error(function(res) {\n                        callback(res, null, new Date() - now);\n                    });\n            },\n            get: function(url, user_token) {\n                var deferred = $q.defer();\n                var header = {};\n                header.Accept = 'application/vnd.github.moondragon+json';\n                if (user_token) {\n                    header.Authorization = 'token ' + user_token;\n                }\n                $http.get(url, { 'headers': header }).\n                success(function(data) {\n                        deferred.resolve(data);\n                        // callback(null, data, status);\n                    })\n                    .error(function(err) {\n                        deferred.reject(err);\n                        // callback(err, null, status);\n                    });\n\n                return deferred.promise;\n            }\n        };\n    }\n]);\n\n\nmodule.factory('$RPC', ['$RAW', '$log',\n    function($RAW, $log) {\n\n        return {\n            call: function(m, functn, data, callback) {\n                var res = new ResultSet();\n                $RAW.call(m, functn, data, function(error, value) {\n                    res.set(error, value);\n                    $log.debug('$RPC', m, functn, data, res, res.error);\n                    if (typeof callback === 'function') {\n                        callback(res.error, res);\n                    }\n                });\n                return res;\n            }\n        };\n    }\n]);\n\n\nmodule.factory('$HUB', ['$RAW', '$log',\n    function($RAW, $log) {\n        function parse_link_header(header) {\n            if (header.length === 0) {\n                throw new Error('input must not be of zero length');\n            }\n\n            // Split parts by comma\n            var parts = header.split(',');\n            var links = {};\n            // Parse each part into a named link\n            parts.forEach(function(p) {\n                var section = p.split(';');\n                if (section.length !== 2) {\n                    throw new Error('section could not be split on \";\"');\n                }\n                var url = section[0].replace(/<(.*)>/, '$1').trim();\n                var name = section[1].replace(/rel=\"(.*)\"/, '$1').trim();\n                links[name] = url;\n            });\n\n            return links;\n        }\n\n        var exec = function(type, res, args, call) {\n            $RAW.call('github', type, args, function(error, value) {\n\n                var data = value ? value.data : null;\n                var meta = value ? value.meta : null;\n\n                if (!data && value) {\n                    data = value;\n                }\n\n                res.set(error, data);\n\n                if (meta) {\n                    res.meta = meta;\n                    var links = meta.link ? parse_link_header(meta.link) : null;\n\n                    res.hasMore = meta.hasMore || (!!links && !!links.next);\n\n                    res.getMore = res.hasMore ? function() {\n\n                        res.loaded = false;\n                        res.loading = true;\n\n                        if (links.next) {\n                            args.url = links.next;\n                        } else {\n                            args.arg.page = args.arg.page + 1 || 2;\n                        }\n\n                        exec(type, res, args, call);\n\n                    } : null;\n                }\n\n                $log.debug('$HUB', args, res, res.error);\n\n                if (typeof call === 'function') {\n                    call(res.error, res);\n                }\n            });\n            return res;\n        };\n\n        return {\n            call: function(o, functn, data, callback) {\n                return exec('call', new ResultSet(), { obj: o, fun: functn, arg: data }, callback);\n            },\n            // direct_call: function(url, data, callback) {\n            //     return exec('direct_call', new ResultSet(), { url: url, arg: data }, callback);\n            // },\n            wrap: function(o, functn, data, callback) {\n                return exec('wrap', new ResultSet(), { obj: o, fun: functn, arg: data }, callback);\n            }\n        };\n    }\n\n\n]);\n\n\n// *****************************************************\n// Angular Route Provider Resolve Promises\n// *****************************************************\n\n\nmodule.factory('$HUBService', ['$q', '$HUB',\n    function($q, $HUB) {\n\n        var exec = function(type, o, functn, data, callback) {\n            var deferred = $q.defer();\n            $HUB[type](o, functn, data, function(err, obj) {\n\n                if (typeof callback === 'function') {\n                    callback(err, obj);\n                }\n\n                if (!err) {\n                    deferred.resolve(obj);\n                }\n                return deferred.reject(err);\n            });\n            return deferred.promise;\n        };\n\n        var exec_direct = function(type, url, data) {\n            var deferred = $q.defer();\n            $HUB[type](url, data, function(err, obj) {\n                if (!err) {\n                    if (obj.hasMore) {\n                        obj.getMore();\n                    } else {\n                        return deferred.resolve(obj);\n                    }\n                } else {\n                    return deferred.reject(err);\n                }\n            });\n            return deferred.promise;\n        };\n\n        return {\n            call: function(o, functn, data, callback) {\n                return exec('call', o, functn, data, callback);\n            },\n            // direct_call: function(url, data) {\n            //     return exec_direct('direct_call', url, data);\n            // },\n            wrap: function(o, functn, data, callback) {\n                return exec('wrap', o, functn, data, callback);\n            }\n        };\n    }\n]);\n\n\n// *****************************************************\n// Angular Route Provider Resolve Promises\n// *****************************************************\n\n\nmodule.factory('$RPCService', ['$q', '$RPC',\n    function($q, $RPC) {\n        return {\n            call: function(o, functn, data, callback) {\n                var deferred = $q.defer();\n                $RPC.call(o, functn, data, function(err, obj) {\n\n                    if (typeof callback === 'function') {\n                        callback(err, obj);\n                    }\n\n                    if (!err) {\n                        deferred.resolve(obj);\n                    }\n                    return deferred.reject();\n                });\n                return deferred.promise;\n            }\n        };\n    }\n]);\n","var module = angular.module('app', ['cla.filters',\n    'cla.config',\n    'ui.utils',\n    'ui.router',\n    'ui.bootstrap',\n    'ui.bootstrap.popover',\n    'ui.select',\n    'ngSanitize',\n    'ngAnimate',\n    'ngCsv',\n    'angulartics',\n    'angulartics.google.analytics'\n]);\n\nvar filters = angular.module('cla.filters', []);\n\nangular.module('cla.config', [])\n    .provider('$config', function () {\n\n        function Config($http) {\n            this.get = function (done) {\n                $http.get('/config')\n                    .success(function (data, status) {\n                        done(data || {}, status);\n                    });\n            };\n        }\n\n        this.$get = ['$http',\n            function ($http) {\n                return new Config($http);\n            }\n        ];\n\n        // var url = $.url();\n        //\n        // this.log = url.param('log') === 'true' || document.location.hostname === 'localhost';\n    });\n// *************************************************************\n// Delay start\n// *************************************************************\n\nangular.element(document).ready(function () {\n    angular.bootstrap(document, ['app']);\n});\n\n// *************************************************************\n// States\n// *************************************************************\n\nmodule.config(['$stateProvider', '$urlRouterProvider', '$locationProvider',\n        function ($stateProvider, $urlRouterProvider, $locationProvider) {\n\n            $stateProvider\n            //\n            // Home state\n            //\n                .state('home', {\n                url: '/',\n                templateUrl: '/templates/home.html',\n                controller: 'HomeCtrl'\n            })\n\n            //\n            // Settings view\n            //\n            .state('home.settings', {\n                // url: '/detail/:user/:repo',\n                templateUrl: '/templates/settings.html',\n                controller: 'SettingsCtrl',\n                params: {\n                    'user': {},\n                    'owner': {},\n                    'repo': {},\n                    'gist': {}\n                }\n                // params: ['user', 'owner', 'repo', 'gist'] <-- was in older angular version\n            })\n\n            //\n            // My-CLA state\n            //\n            .state('cla', {\n                abstract: true,\n                url: '/my-cla',\n                template: '<section ui-view></section>'\n            })\n\n\n            .state('cla.myCla', {\n                url: '',\n                templateUrl: '/templates/my-cla.html',\n                controller: 'MyClaCtrl'\n            })\n\n            //\n            // Repo state (abstract)\n            //\n            .state('repo', {\n                abstract: true,\n                url: '/:user/:repo?pullRequest&redirect',\n                template: '<section ui-view></section>'\n            })\n\n            //\n            // Repo cla\n            //\n            .state('repo.cla', {\n                url: '',\n                templateUrl: '/templates/cla.html',\n                controller: 'ClaController'\n            })\n\n            //\n            // 404 Error\n            //\n            .state('404', {\n                url: '/404',\n                templateUrl: '/templates/404.html'\n            });\n\n            $urlRouterProvider.otherwise('/404');\n\n            $locationProvider.html5Mode({\n                enabled: true,\n                requireBase: false\n            });\n        }\n    ])\n    .run(['$rootScope', '$state', '$stateParams', '$config',\n        function ($rootScope, $state, $stateParams, $config) {\n            $rootScope.$state = $state;\n            $rootScope.$stateParams = $stateParams;\n\n            $config.get(function (data) {\n                $rootScope.$config = data;\n                if (data.gacode) {\n                    ga('create', data.gacode, 'auto');\n                }\n            });\n        }\n    ]);\n","// *****************************************************\n// CLA Controller\n//\n// tmpl: cla.html\n// *****************************************************\n\nmodule.controller('ClaController', ['$window', '$scope', '$stateParams', '$RAW', '$RPCService', '$HUBService', '$sce', '$timeout', '$http', '$q', 'utils',\n\t\tfunction ($window, $scope, $stateParams, $RAW, $RPCService, $HUBService, $sce, $timeout, $http, $q, utils) {\n\n\t\t\t$scope.cla = null;\n\t\t\t$scope.customFields = {};\n\t\t\t$scope.customValues = {};\n\t\t\t$scope.hasCustomFields = false;\n\t\t\t$scope.linkedItem = null;\n\t\t\t$scope.noLinkedItemError = false;\n\t\t\t$scope.params = $stateParams;\n\t\t\t$scope.user = {};\n\t\t\t$scope.signed = false;\n\t\t\t$scope.isSharedSignature = false;\n\n\t\t\tfunction getUserEmail(key) {\n\t\t\t\t$HUBService.call('users', 'getEmails', {}, function (err, data) {\n\t\t\t\t\tif (data && data.value) {\n\t\t\t\t\t\tdata.value.some(function (email) {\n\t\t\t\t\t\t\t$scope.customValues[key] = email.primary ? email.email : $scope.customValues[key];\n\t\t\t\t\t\t\treturn email.primary;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction getGithubValues() {\n\t\t\t\tif ($scope.hasCustomFields && $scope.user.value && !$scope.signed) {\n\t\t\t\t\t$scope.customKeys.forEach(function (key) {\n\t\t\t\t\t\tvar githubKey = $scope.customFields[key].githubKey;\n\t\t\t\t\t\tif (githubKey) {\n\t\t\t\t\t\t\t$scope.customValues[key] = $scope.user.value[githubKey];\n\t\t\t\t\t\t\tif (githubKey === 'email' && !$scope.user.value.email) {\n\t\t\t\t\t\t\t\tgetUserEmail(key);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction getSignedValues() {\n\t\t\t\t$RPCService.call('cla', 'getLastSignature', {\n\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\towner: $stateParams.user\n\t\t\t\t}, function (err, res) {\n\t\t\t\t\tif ($scope.hasCustomFields && res && res.value && res.value.custom_fields) {\n\t\t\t\t\t\tvar customFields = JSON.parse(res.value.custom_fields);\n\t\t\t\t\t\t$scope.customKeys.forEach(function (key) {\n\t\t\t\t\t\t\t$scope.customValues[key] = customFields[key];\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$scope.isSharedSignature = isSharedSignature(res.value);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction isSharedSignature(cla) {\n\t\t\t\treturn cla && !cla.owner;\n\t\t\t}\n\n\t\t\tfunction getCLA() {\n\t\t\t\treturn utils.getGistContent($scope.linkedItem.repoId, $scope.linkedItem.orgId).then(\n\t\t\t\t\tfunction success(gistContent) {\n\t\t\t\t\t\t$scope.cla = $sce.trustAsHtml(gistContent.claText);\n\t\t\t\t\t\t$scope.cla.text = gistContent.claText;\n\t\t\t\t\t\t$scope.claText = gistContent.claText;\n\n\t\t\t\t\t\t$scope.customFields = gistContent.customFields;\n\t\t\t\t\t\t$scope.customKeys = gistContent.customKeys;\n\t\t\t\t\t\t$scope.hasCustomFields = gistContent.hasCustomFields;\n\t\t\t\t\t},\n\t\t\t\t\tfunction error(err) {\n\t\t\t\t\t\t$scope.noLinkedItemError = err.message || err;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tfunction checkCLA() {\n\t\t\t\treturn $RPCService.call('cla', 'check', {\n\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\towner: $stateParams.user\n\t\t\t\t}, function (err, signed) {\n\t\t\t\t\tif (!err && signed.value) {\n\t\t\t\t\t\t$scope.signed = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.signed = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction getLinkedItem(callback) {\n\t\t\t\treturn $RPCService.call('cla', 'getLinkedItem', {\n\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\towner: $stateParams.user\n\t\t\t\t}, function (err, linkedItem) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\t$scope.noLinkedItemError = err.message || err;\n\t\t\t\t\t}\n\t\t\t\t\tcallback(linkedItem.value);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar getUser = function () {\n\t\t\t\treturn $HUBService.call('users', 'get', {}, function (err, res) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$scope.user = res;\n\t\t\t\t\t$scope.user.value.admin = false;\n\t\t\t\t\tif (res.meta && res.meta.scopes && res.meta.scopes.indexOf('write:repo_hook') > -1) {\n\t\t\t\t\t\t$scope.user.value.admin = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar redirect = function () {\n\t\t\t\t$scope.redirect = 'https://github.com/' + $stateParams.user + '/' + $stateParams.repo;\n\t\t\t\tif ($stateParams.pullRequest) {\n\t\t\t\t\t$scope.redirect = $scope.redirect + '/pull/' + $stateParams.pullRequest;\n\t\t\t\t}\n\t\t\t\t// $http.get('/logout?noredirect=true');\n\t\t\t\t$timeout(function () {\n\t\t\t\t\t$window.location.href = $scope.redirect;\n\t\t\t\t}, 5000);\n\t\t\t};\n\n\t\t\t$scope.agree = function () {\n\t\t\t\tif (!$scope.hasCustomFields) {\n\t\t\t\t\tvar acceptUrl = '/accept/' + $stateParams.user + '/' + $stateParams.repo;\n\t\t\t\t\tacceptUrl = $stateParams.pullRequest ? acceptUrl + '?pullRequest=' + $stateParams.pullRequest : acceptUrl;\n\t\t\t\t\t$window.location.href = acceptUrl;\n\t\t\t\t} else if ($scope.user.value && $scope.hasCustomFields) {\n\t\t\t\t\t$RPCService.call('cla', 'sign', {\n\t\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\t\towner: $stateParams.user,\n\t\t\t\t\t\tcustom_fields: JSON.stringify($scope.customValues)\n\t\t\t\t\t}, function (err, signed) {\n\t\t\t\t\t\t$scope.signed = signed.value;\n\t\t\t\t\t\tif ($scope.signed) {\n\t\t\t\t\t\t\tredirect();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$scope.signIn = function () {\n\t\t\t\tvar acceptUrl = '/signin/' + $stateParams.user + '/' + $stateParams.repo;\n\t\t\t\t$window.location.href = $stateParams.pullRequest ? acceptUrl + '?pullRequest=' + $stateParams.pullRequest : acceptUrl;\n\t\t\t};\n\n\t\t\tvar userPromise = getUser();\n\t\t\tvar claPromise;\n\t\t\tvar repoPromise = getLinkedItem(function (linkedItem) {\n\t\t\t\t$scope.linkedItem = linkedItem;\n\t\t\t\tif ($scope.linkedItem) {\n\t\t\t\t\tclaPromise = getCLA();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$scope.isValid = function () {\n\t\t\t\tvar valid = true;\n\n\t\t\t\tfunction isNotEmpty(value) {\n\t\t\t\t\treturn !!value || value === 0;\n\t\t\t\t}\n\n\t\t\t\tfunction typeIsValid(value, field) {\n\t\t\t\t\treturn typeof value == field.type || field.type.enum || field.type == 'textarea';\n\t\t\t\t}\n\n\t\t\t\t$scope.customKeys.some(function (key) {\n\t\t\t\t\tvar value = $scope.customValues[key];\n\t\t\t\t\tvar field = $scope.customFields[key];\n\t\t\t\t\tvalid = !field.required || (isNotEmpty(value) && typeIsValid(value, field));\n\t\t\t\t\treturn !valid;\n\t\t\t\t});\n\t\t\t\treturn valid;\n\t\t\t};\n\n\t\t\t$scope.showSharedGistMsg = function () {\n\t\t\t\treturn $scope.linkedItem && $scope.linkedItem.sharedGist && (!$scope.signed || ($scope.signed && $scope.isSharedSignature));\n\t\t\t};\n\n\t\t\t$q.all([userPromise, repoPromise]).then(function () {\n\t\t\t\tif ($scope.user && $scope.user.value && $scope.linkedItem) {\n\t\t\t\t\t// var claPromise = getCLA();\n\t\t\t\t\tvar signedPromise = checkCLA().then(function (signed) {\n\t\t\t\t\t\t// $scope.customValues = signed.value ? {} : $scope.customValues;\n\t\t\t\t\t\tif (signed.value && $stateParams.redirect) {\n\t\t\t\t\t\t\tredirect();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$q.all([claPromise, signedPromise]).then(function () {\n\t\t\t\t\t\tif ($scope.signed) {\n\t\t\t\t\t\t\tgetSignedValues();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgetGithubValues();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t])\n\t.directive('customfield', [function () {\n\t\treturn {\n\t\t\ttemplateUrl: '/templates/customField.html',\n\t\t\tscope: {\n\t\t\t\tdescription: '=',\n\t\t\t\tkey: '=',\n\t\t\t\tlogged: '=',\n\t\t\t\tmin: '=',\n\t\t\t\tmax: '=',\n\t\t\t\tname: '=',\n\t\t\t\trequired: '=',\n\t\t\t\tsigned: '=',\n\t\t\t\ttitle: '=',\n\t\t\t\ttype: '=',\n\t\t\t\tvalue: '=',\n\t\t\t}\n\t\t};\n\t}]);\n","// *****************************************************\n// Home Controller\n//\n// tmpl: home.html\n// path: /\n// *****************************************************\n\nvar isInArray = function (item, items) {\n    function check(linkedItem) {\n        if (!item.full_name) {\n            return linkedItem.org === item.login;\n        } else {\n            return (linkedItem.repo === item.name && linkedItem.owner === item.owner.login) || linkedItem.org === item.owner.login;\n        }\n    }\n    return items.some(check);\n};\n\nvar deleteFromArray = function (item, array) {\n    var i = array.indexOf(item);\n    if (i > -1) {\n        array.splice(i, 1);\n    }\n};\n\nmodule.controller('HomeCtrl', ['$rootScope', '$scope', '$document', '$HUB', '$RPC', '$RPCService', '$RAW', '$HUBService', '$window', '$modal', '$timeout', '$q', '$location', 'utils',\n        function ($rootScope, $scope, $document, $HUB, $RPC, $RPCService, $RAW, $HUBService, $window, $modal, $timeout, $q, $location, utils) {\n\n            $scope.active = 0;\n            $scope.claRepos = [];\n            $scope.claOrgs = [];\n            $scope.defaultClas = [];\n            $scope.errorMsg = [];\n            $scope.gists = [];\n            $scope.nextstep = {\n                step1: true\n            };\n            $scope.openSettings = false;\n            $scope.orgs = [];\n            $scope.query = {};\n            $scope.repos = [];\n            $scope.reposAndOrgs = [];\n            $scope.selected = {};\n            $scope.selectedIndex = -1;\n            $scope.users = [];\n            $scope.user = {};\n            $scope.isLoading = false;\n\n            $scope.logAdminIn = function () {\n                $window.location.href = '/auth/github';\n            };\n\n            var mixOrgData = function (claOrg) {\n                $scope.orgs.some(function (org) {\n                    if (org.id == claOrg.orgId) {\n                        claOrg.avatar_url = org.avatar_url;\n                        return true;\n                    }\n                });\n            };\n\n            var getLinkedOrgs = function () {\n                $scope.claOrgs = [];\n                return $RPCService.call('org', 'getForUser', {}).then(function (data) {\n                    if (data && data.value) {\n                        data.value.forEach(function (org) {\n                            mixOrgData(org);\n                            $scope.claOrgs.push(org);\n                        });\n                    }\n                });\n            };\n\n            var mixRepoData = function (claRepo) {\n                $scope.repos.some(function (repo) {\n                    if (claRepo.repo === repo.name && claRepo.owner === repo.owner.login) {\n                        claRepo.fork = repo.fork;\n                        return true;\n                    }\n                });\n                return claRepo;\n            };\n\n            var getLinkedRepos = function () {\n                var repoSet = [];\n                $scope.repos.forEach(function (repo) {\n                    repoSet.push({\n                        repoId: repo.id\n                    });\n                });\n                return $RPCService.call('repo', 'getAll', {\n                    set: repoSet\n                }).then(function (data) {\n                    if (!data) {\n                        return;\n                    }\n                    $scope.claRepos = data.value;\n                    $scope.claRepos.forEach(function (claRepo) {\n                        claRepo = mixRepoData(claRepo);\n                    });\n                });\n            };\n\n            var getUser = function () {\n                $rootScope.user = {\n                    value: {\n                        admin: false\n                    }\n                };\n\n                return $HUBService.call('users', 'get', {}, function (err, res) {\n                    if (err) {\n                        return;\n                    }\n\n                    $scope.user = res;\n                    $scope.user.value.admin = res.meta.scopes && res.meta.scopes.indexOf('write:repo_hook') > -1 ? true : false;\n                    $scope.user.value.org_admin = res.meta.scopes && res.meta.scopes.indexOf('admin:org_hook') > -1 ? true : false;\n                    $rootScope.user = $scope.user;\n                    $rootScope.$broadcast('user');\n                });\n            };\n\n            var getRepos = function () {\n                if ($scope.user && $scope.user.value && $scope.user.value.admin) {\n                    return $HUBService.call('repos', 'getAll', {\n                        per_page: 100,\n                        affiliation: 'owner,organization_member'\n                    }).then(function (data) {\n                        data.value.forEach(function (repo) {\n                            if (repo.permissions.push) {\n                                $scope.repos.push(repo);\n                            }\n                        });\n                        if ($scope.repos.length > 0) {\n                            return getLinkedRepos();\n                        }\n                    });\n                }\n            };\n\n            var getGists = function () {\n                $scope.gists = [];\n                if (!$scope.defaultClas.length) {\n                    $scope.getDefaultClaFiles().then(function () {\n                        $scope.gists = $scope.gists.concat($scope.defaultClas);\n                    });\n                }\n                $scope.gists = $scope.defaultClas.concat([]);\n\n                $HUBService.call('gists', 'getAll').then(function (data) {\n                    if (data && data.value) {\n                        data.value.forEach(function (gist) {\n                            var gistFile = {};\n                            gistFile.name = utils.getGistAttribute(gist, 'filename');\n                            gistFile.url = gist.html_url;\n                            $scope.gists.push(gistFile);\n                        });\n                    }\n                });\n            };\n\n            var getOrgs = function () {\n                var deferred = $q.defer();\n                if (!$scope.user.value.org_admin) {\n                    deferred.resolve();\n                    return deferred.promise;\n                }\n                return $RPCService.call('org', 'getGHOrgsForUser').then(function (res) {\n                    if (res && res.value) {\n                        $scope.orgs = res.value;\n                    }\n                    if ($scope.orgs.length > 0) {\n                        return getLinkedOrgs();\n                    }\n                });\n            };\n\n            var showErrorMessage = function (text) {\n                var error = text;\n                $timeout(function () {\n                    deleteFromArray(error, $scope.errorMsg);\n                }, 5000);\n\n                $scope.errorMsg.push(error);\n            };\n\n            var linkSuccess = function () {\n                var modal = $modal.open({\n                    templateUrl: '/modals/templates/linkSuccess.html',\n                    controller: 'LinkCtrl',\n                    windowClass: 'link-success',\n                    scope: $scope,\n                    resolve: {\n                        selected: function () {\n                            return $scope.selected;\n                        }\n                    }\n                });\n\n                modal.result.then(function () {\n                    $scope.selected = {};\n                    $scope.newLink = false;\n                }, function () {\n                    $scope.selected = {};\n                    $scope.newLink = false;\n                });\n            };\n\n            var confirmAdd = function () {\n                var modal = $modal.open({\n                    templateUrl: '/modals/templates/confirmLink.html',\n                    controller: 'ConfirmCtrl',\n                    windowClass: 'confirm-add',\n                    resolve: {\n                        selected: function () {\n                            return $scope.selected;\n                        }\n                    }\n                });\n                modal.result.then(function () {\n                    $scope.linkStatus = null;\n                    linkSuccess();\n                    $scope.link().then(function () {\n                        $scope.linkStatus = 'linked';\n                    }, function () {\n                        $scope.linkStatus = 'failed';\n                    });\n                });\n            };\n\n            $scope.confirmRemove = function (linkedItem) {\n                var modal = $modal.open({\n                    templateUrl: '/modals/templates/confirmRemove.html',\n                    controller: 'ConfirmCtrl',\n                    windowClass: 'confirm-add',\n                    resolve: {\n                        selected: function () {\n                            return {\n                                item: linkedItem\n                            };\n                        }\n                    }\n                });\n                modal.result.then(function (org) {\n                    $scope.remove(org);\n                });\n            };\n\n            $scope.info = function () {\n                $modal.open({\n                    templateUrl: '/modals/templates/info_gist.html',\n                    controller: 'InfoCtrl',\n                    windowClass: 'howto'\n                });\n            };\n\n            $scope.addScope = function () {\n                var modal = $modal.open({\n                    templateUrl: '/modals/templates/add_scope.html',\n                    controller: 'AddScopeCtrl',\n                    windowClass: 'howto'\n                });\n                modal.result.then(function () {\n                    $window.location.href = '/auth/github?admin=true&org_admin=true';\n                });\n            };\n\n            $scope.gistShareInfo = function () {\n                $modal.open({\n                    templateUrl: '/modals/templates/info_share_gist.html',\n                    controller: 'InfoCtrl',\n                    windowClass: 'howto'\n                });\n            };\n\n            $scope.getDefaultClaFiles = function () {\n                var promise = $RAW.get('/static/cla-assistant.json');\n                promise.then(function (data) {\n                    $scope.defaultClas = data['default-cla'];\n                });\n                return promise;\n            };\n\n            $scope.count = function () {\n                $RAW.get('/count/clas').then(function (data) {\n                    $scope.numberClas = data.count;\n                });\n                $RAW.get('/count/repos').then(function (data) {\n                    $scope.numberRepos = data.count;\n                });\n                $RAW.get('/count/stars').then(function (data) {\n                    $scope.numberStars = data.count;\n                });\n            };\n\n            getUser().then(function () {\n                $scope.isLoading = true;\n                $q.all([\n                    getOrgs(),\n                    getRepos(),\n                    getGists()\n                ]).then(function () {\n                    $scope.reposAndOrgs = $scope.user.value.org_admin ? $scope.orgs.concat($scope.repos) : $scope.repos;\n                    $scope.isLoading = false;\n                }, function () {\n                    $scope.isLoading = false;\n                });\n            }, function () {\n                $scope.count();\n            });\n\n            $scope.clear = function ($event, obj) {\n                $event.stopPropagation();\n                if (obj === 'repo') {\n                    $scope.selected.item = undefined;\n                } else if (obj === 'gist') {\n                    $scope.selected.gist = undefined;\n                }\n            };\n\n            $scope.isValid = function (gist) {\n                var valid = false;\n                // valid = value ? !!value.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)\\/[a-zA-Z0-9]*$/) : false;\n                valid = gist ? !!gist.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)/) : false;\n                return valid;\n            };\n\n            $scope.isRepo = function (item) {\n                return item.full_name ? true : false;\n            };\n\n            $scope.addWebhook = function (item) {\n                if (item.gist) {\n                    $RPCService.call('webhook', 'create', item, function (err, data) {\n                        if (!err && data && data.value) {\n                            item.active = data.value.active;\n                        }\n                    });\n                }\n            };\n\n            $scope.removeWebhook = function (linkedItem) {\n                var arg = linkedItem.org ? {\n                    org: linkedItem.org\n                } : {\n                    repo: linkedItem.repo,\n                    owner: linkedItem.owner\n                };\n                $RPCService.call('webhook', 'remove', arg, function () {});\n            };\n\n\n            $scope.linkCla = function () {\n                confirmAdd();\n            };\n\n            var linkItem = function (obj, item) {\n                var linkedArray = obj === 'org' ? $scope.claOrgs : $scope.claRepos;\n                var promise1 = $RPCService.call(obj, 'create', item, function (err, data) {\n                    if (err && err.errmsg.match(/.*duplicate key error.*/)) {\n                        showErrorMessage('This repository is already set up.');\n                    } else if (err || !data.value) {\n                        err && err.errmsg ? showErrorMessage(err.errmsg) : null;\n                        $scope.removeWebhook(item);\n                        deleteFromArray(item, linkedArray);\n                    } else {\n                        linkedArray.push(item);\n                        $scope.query.text = '';\n                    }\n                });\n\n                item.active = false;\n\n                var promise2 = $scope.addWebhook(item);\n                return $q.all([promise1, promise2]);\n            };\n\n            var linkRepo = function () {\n                var newClaRepo = {\n                    repo: $scope.selected.item.name,\n                    owner: $scope.selected.item.owner.login,\n                    repoId: $scope.selected.item.id,\n                    gist: $scope.selected.gist.url,\n                    sharedGist: $scope.selected.sharedGist\n                };\n                newClaRepo = mixRepoData(newClaRepo);\n                return linkItem('repo', newClaRepo);\n            };\n\n            var linkOrg = function () {\n                var newClaOrg = {\n                    orgId: $scope.selected.item.id,\n                    org: $scope.selected.item.login,\n                    gist: $scope.selected.gist.url,\n                    excludePattern: $scope.selected.item.excludePattern,\n                    sharedGist: $scope.selected.sharedGist\n                };\n                mixOrgData(newClaOrg);\n                return linkItem('org', newClaOrg);\n            };\n\n            $scope.link = function () {\n                return $scope.isRepo($scope.selected.item) ? linkRepo() : linkOrg();\n            };\n\n            $scope.remove = function (linkedItem) {\n                var api = linkedItem.orgId ? 'org' : 'repo';\n                var removeArgs = linkedItem.orgId ? {\n                    orgId: linkedItem.orgId\n                } : {\n                    repoId: linkedItem.repoId\n                };\n                $RPCService.call(api, 'remove', removeArgs, function (err) {\n                    if (!err) {\n                        return api === 'org' ? getLinkedOrgs() : getLinkedRepos();\n                    }\n                });\n\n                $scope.removeWebhook(linkedItem);\n            };\n\n            $scope.isActive = function (viewLocation) {\n                return viewLocation === $location.url();\n            };\n\n            $scope.groupDefaultCla = function (gist) {\n                var found = false;\n\n                $scope.defaultClas.some(function (defCla) {\n                    if (gist.url === defCla.url) {\n                        found = true;\n                        return found;\n                    }\n                });\n\n                return found ? 'Default CLAs' : 'My Gist Files';\n            };\n\n            $scope.groupOrgs = function (item) {\n                return item.full_name ? 'Repositories' : 'Organisations';\n            };\n\n        }\n    ])\n    .directive('feature', ['$window', function () {\n        return {\n            templateUrl: '/templates/feature.html',\n            scope: {\n                id: '@',\n                iconSrc: '@',\n                header: '@',\n                text: '@'\n            }\n        };\n    }])\n    .directive('textSlider', ['$window', '$timeout', function ($window, $timeout) {\n        return {\n            scope: {\n                time: '@',\n                active: '='\n            },\n            link: function (scope, element) {\n                var children = element.children();\n                var start = function () {\n                    $timeout(function () {\n                        scope.active = scope.active + 1 === children.length ? 0 : scope.active + 1;\n                        start();\n                    }, scope.time);\n                };\n\n                start();\n            }\n        };\n    }]);\n\nfilters.filter('notIn', function () {\n    return function (items, arr) {\n\n        if (arr.length === 0) {\n            return items;\n        }\n\n        var notMatched = [];\n\n        items.forEach(function (item) {\n            if (!isInArray(item, arr)) {\n                notMatched.push(item);\n            }\n        });\n        return notMatched;\n    };\n});\n","// *****************************************************\n// My-CLA Controller\n//\n// tmpl: my-cla.html.html\n// path: /\n// *****************************************************\n\nmodule.controller('MyClaCtrl', ['$scope', '$filter', '$HUB', '$RAW', '$RPCService', '$HUBService', '$modal', 'utlis',\n    function ($scope, $filter, $HUB, $RAW, $RPCService, $HUBService, $modal, utils) {\n      $scope.repos = [];\n      $scope.gists = [];\n      $scope.signedCLAs = [];\n      $scope.signedCLAs = [];\n      $scope.users = [];\n      $scope.user = {};\n      $scope.defaultClas = [];\n\n      var orderBy = $filter('orderBy');\n\n      var getUser = function(){\n          $scope.user = {value: {admin: false}};\n\n          return $HUBService.call('user', 'get', {}, function(err, res){\n              if (err) {\n                  return;\n              }\n\n              $scope.user = res;\n              $scope.user.value.admin = false;\n\n              if (res.meta.scopes.indexOf('write:repo_hook') > -1) {\n                  $scope.user.value.admin = true;\n              }\n              //$rootScope.user = $scope.user;\n              //$rootScope.$broadcast('user');\n          });\n      };\n\n      var getSignedCLA = function(){\n        return $RPCService.call('cla', 'getSignedCLA', {\n            user: $scope.user.value.login\n          }, function(err, data){\n              if(!err && data){\n                  $scope.signedCLAs = data.value;\n                  for(var i = 0; i < $scope.signedCLAs.length; i++){\n                    $scope.getGist($scope.signedCLAs[i]);\n                    $scope.getVersionStatus($scope.signedCLAs[i]);\n                  }\n              }\n        });\n      };\n\n      $scope.getGist = function(repo){\n          $RPCService.call('cla', 'getGist', {\n            repo: repo.repo,\n            owner: repo.owner,\n            gist: {\n              gist_url: repo.gist_url,\n              gist_version: repo.gist_version\n            }\n            }, function(err, data){\n              if (!err && data.value) {\n                  repo.gistObj = data.value;\n              }\n          });\n      };\n\n      $scope.getGistName = function(gistObj){\n          return utils.getGistAttribute(gistObj, 'filename');\n      };\n\n      getUser().then(function(){\n          getSignedCLA();\n      });\n\n      $scope.order = function(predicate, reverse){\n        $scope.signedCLAs = orderBy($scope.signedCLAs, predicate, reverse);\n      };\n\n      $scope.getDefaultClaFiles = function(){\n          return $RAW.get('/static/cla-assistant.json').then(function(data){\n            $scope.defaultClas = data['default-cla'];\n          });\n      };\n\n      $scope.getClaView = function(signedCLA) {\n          $modal.open({\n              templateUrl: '/modals/templates/claView.html',\n              controller: 'ClaViewCtrl',\n              scope: $scope,\n              resolve: {\n                  cla: function(){ return signedCLA; }\n              }\n          });\n      };\n\n      $scope.getGistVersion = function(gistObj){\n          return utils.getGistAttribute(gistObj, 'updated_at');\n      };\n\n      $scope.getVersionView = function(signedCLA) {\n            if (signedCLA.newCLA) {\n                signedCLA.noCLA = false;\n\n                if(signedCLA.newCLA.html_url !== signedCLA.gist_url){\n                  signedCLA.showCLA = true;\n                } else {\n                  signedCLA.showCLA = false;\n                }\n            } else {\n                signedCLA.noCLA = true;\n            }\n          $modal.open({\n              templateUrl: '/modals/templates/versionView.html',\n              controller: 'VersionViewCtrl',\n              scope: $scope,\n              resolve: {\n                  cla: function(){ return signedCLA; },\n                  noCLA: function(){ return signedCLA.noCLA; },\n                  showCLA: function(){ return signedCLA.showCLA; }\n              }\n          });\n      };\n\n      function getLinkedGist(signedCLA) {\n          return $RPCService.call('cla', 'getGist', {\n            repo: signedCLA.repo,\n            owner: signedCLA.owner\n          }, function (err, data){\n              if(!err && data.value){\n                signedCLA.newCLA = data.value;\n              }\n          });\n      }\n\n      function checkCLA(signedCLA) {\n          return $RPCService.call('cla', 'check', {\n              repo: signedCLA.repo,\n              owner: signedCLA.owner\n          }, function(err, signed){\n              if (!err && signed.value && signed) {\n                  signedCLA.signed = true;\n              }else {\n                  signedCLA.signed = false;\n                  getLinkedGist(signedCLA);\n              }\n          });\n      }\n\n      $scope.getVersionStatus = function(signedCLA) {\n        checkCLA(signedCLA).then(function(){\n          if (signedCLA.signed) {\n              signedCLA.stat = true;\n          }else{\n              signedCLA.stat = false;\n          }\n        });\n      };\n    }\n]);\n","// *****************************************************\n// Detail Controller\n//\n// tmpl: detail.html\n// path: /detail/:ruser/:repo\n// *****************************************************\n\nmodule.controller('SettingsCtrl', ['$rootScope', '$scope', '$stateParams', '$HUB', '$RPC', '$RPCService', '$HUBService', '$window', '$sce', '$modal', '$q', 'utils',\n    function($rootScope, $scope, $stateParams, $HUB, $RPC, $RPCService, $HUBService, $window, $sce, $modal, $q, utils) {\n\n        $scope.gist = {};\n        $scope.gistIndex = 0;\n        $scope.admin = false;\n        $scope.errorMsg = [];\n        $scope.loading = false;\n        $scope.gistUrlIsValid = true;\n        $scope.valid = {};\n        $scope.signatures = {};\n        $scope.contributors = [];\n        var webhook = {};\n\n        var csvHeader = ['User Name', 'Repository Owner', 'Repository Name', 'CLA Title', 'Gist URL', 'Gist Version', 'Signed At', 'Signed for Organization'];\n        $scope.csvHeader = csvHeader.concat();\n\n        function gistArgs() {\n            var args = {\n                gist_url: $scope.item.gist\n            };\n            if ($scope.gist.history && $scope.gist.history.length > 0) {\n                args.gist_version = $scope.gist.history[$scope.gistIndex].version;\n            }\n            return args;\n        }\n        // var validateGistUrl = function (gist_url) {\n        //     var valid = false;\n        //     valid = gist_url ? !!gist_url.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)/) : false;\n        //     return valid ? gist_url : undefined;\n        // };\n\n        $scope.open_error = function() {\n            $modal.open({\n                templateUrl: '/modals/templates/error_modal.html',\n                controller: 'ErrorCtrl'\n            });\n        };\n\n        $scope.getSignatures = function(linkedItem, gist_version, cb) {\n            return $RPC.call('cla', 'getAll', {\n                repoId: linkedItem.repoId,\n                orgId: linkedItem.orgId,\n                gist: {\n                    gist_url: linkedItem.gist,\n                    gist_version: gist_version\n                },\n                sharedGist: linkedItem.sharedGist\n            }, cb);\n        };\n\n        var getCustomFields = function(linkedItem, gist_version, cb) {\n            utils.getGistContent(linkedItem.repoId, linkedItem.orgId, linkedItem.gist, gist_version).then(\n                function(gistContent) {\n                    if (gistContent.hasCustomFields) {\n                        $scope.csvHeader = csvHeader.concat();\n                        gistContent.customKeys.forEach(function(key) {\n                            var field = gistContent.customFields[key];\n                            $scope.csvHeader.push(field.title || key);\n                        });\n                        cb(null, gistContent.customKeys);\n                    } else {\n                        cb();\n                    }\n                },\n                function fail(err) {\n                    cb(err);\n                }\n            );\n        };\n\n        var getWebhook = function() {\n            return $RPCService.call('webhook', 'get', {\n                repo: $scope.item.repo,\n                owner: $scope.item.owner,\n                org: $scope.item.org\n            }, function(err, obj) {\n                if (!err && obj && obj.value) {\n                    webhook = obj.value;\n                    $scope.valid.webhook = webhook.active;\n                }\n            });\n        };\n\n        $scope.getContributors = function(gist_version, cb) {\n            var customKeys;\n            getCustomFields($scope.item, gist_version, function(err, keys) {\n                customKeys = keys ? keys : customKeys;\n\n                $scope.getSignatures($scope.item, gist_version, function(err, data) {\n                    $scope.contributors = [];\n                    if (data && data.value && data.value.length > 0) {\n                        data.value.forEach(function(signature) {\n                            var contributor = {};\n                            contributor.user_name = signature.user;\n                            contributor.repo_owner = signature.owner;\n                            contributor.repo_name = signature.repo;\n                            contributor.gist_name = $scope.getGistName();\n                            contributor.gist_url = signature.gist_url;\n                            contributor.gist_version = signature.gist_version;\n                            contributor.signed_at = signature.created_at;\n                            contributor.org_cla = signature.org_cla;\n                            if (customKeys && signature.custom_fields) {\n                                var customFields = JSON.parse(signature.custom_fields);\n                                customKeys.forEach(function(key) {\n                                    contributor[key] = customFields[key];\n                                });\n                            }\n                            $scope.contributors.push(contributor);\n                        });\n                    }\n                    if (typeof cb == 'function') {\n                        cb();\n                    }\n                });\n            });\n\n        };\n\n        $scope.getGist = function() {\n            return $RPCService.call('cla', 'getGist', {\n                repo: $scope.item.repo,\n                owner: $scope.item.owner,\n                gist: gistArgs()\n            }, function(err, data) {\n                if (!err && data.value) {\n                    $scope.gist = data.value;\n                    $scope.valid.gist = $scope.gist && $scope.gist.id ? true : false;\n                    getCustomFields($scope.item, gistArgs().gist_version, function(err) {\n                        $scope.valid.gist = err ? false : $scope.valid.gist;\n                    });\n                }\n                $scope.gist.linked = true;\n            });\n        };\n\n        $scope.getGistName = function() {\n            $scope.gist.fileName = $scope.gist.fileName ? $scope.gist.fileName : utils.getGistAttribute($scope.gist, 'filename');\n            return $scope.gist.fileName;\n        };\n\n        // var showErrorMessage = function(text) {\n        //     var error = text;\n        //     $timeout(function(){\n        //         var i = $scope.errorMsg.indexOf(error);\n        //         if (i > -1) {\n        //             $scope.errorMsg.splice(i, 1);\n        //         }\n        //     }, 3000);\n\n        //     $scope.errorMsg.push(error);\n        // };\n\n        $scope.validateLinkedItem = function() {\n            var promises = [];\n            if ($scope.item.gist) {\n                $scope.loading = true;\n                promises.push($scope.getGist());\n                promises.push(getWebhook());\n                $q.all(promises).then(function() {\n                    $scope.signatures = $scope.getSignatures($scope.item, gistArgs().gist_version);\n                    $scope.loading = false;\n                });\n            }\n        };\n\n        $scope.isLinkActive = function() {\n            return !$scope.loading && $scope.valid.gist && $scope.valid.webhook;\n        };\n\n        $scope.renderHtml = function(html_code) {\n            return $sce.trustAsHtml(html_code);\n        };\n\n        var report = function(linkedItem) {\n            $modal.open({\n                templateUrl: '/modals/templates/report.html',\n                controller: 'ReportCtrl',\n                windowClass: 'report',\n                scope: $scope,\n                resolve: {\n                    item: function() {\n                        return linkedItem;\n                    }\n                }\n            });\n        };\n\n        $scope.getReport = function() {\n            if ($scope.signatures.value.length > 0) {\n                $scope.getContributors(gistArgs().gist_version);\n            }\n            report($scope.item);\n        };\n\n        var validateRepoPr = function(repo, owner) {\n            $scope.validatePR = $RPC.call('cla', 'validatePullRequests', {\n                repo: repo,\n                owner: owner\n            }, function() {\n                $scope.popoverIsOpen = false;\n            });\n        };\n        var validateOrgPr = function(linkedItem) {\n            $RPCService.call('cla', 'validateOrgPullRequests', {\n                org: linkedItem.org\n            }).then(function() {\n                $scope.popoverIsOpen = false;\n            });\n        };\n\n        $scope.recheck = function(linkedItem) {\n            if (linkedItem.org) {\n                validateOrgPr(linkedItem);\n            } else {\n                validateRepoPr(linkedItem.repo, linkedItem.owner);\n            }\n        };\n\n        $scope.upload = function(linkedItem) {\n            $scope.popoverIsOpen = false;\n            var modal = $modal.open({\n                templateUrl: '/modals/templates/upload.html',\n                controller: 'UploadCtrl',\n                windowClass: 'upload'\n            });\n            modal.result.then(function(users) {\n                $RPCService.call('cla', 'upload', {\n                    repo: linkedItem.repo,\n                    owner: linkedItem.owner || linkedItem.org,\n                    users: users\n                }).then($scope.validateLinkedItem);\n            });\n        };\n\n        $scope.getBadge = function(claRepo) {\n            $scope.popoverIsOpen = false;\n            $modal.open({\n                templateUrl: '/modals/templates/badge.html',\n                controller: 'BadgeCtrl',\n                windowClass: 'get-badge',\n                resolve: {\n                    repo: function() {\n                        return claRepo;\n                    }\n                }\n            });\n        };\n\n        $scope.validateLinkedItem();\n    }\n]);\n\nmodule.directive('settings', ['$document', function($document) {\n    return {\n        templateUrl: '/templates/settings.html',\n        controller: 'SettingsCtrl',\n        transclude: true,\n        scope: {\n            item: '=',\n            user: '=',\n            repos: '='\n        },\n        link: function(scope, element) {\n            var documentClickHandler = function(event) {\n                var eventOutsideTarget = (element[0] !== event.target) && (element.find(event.target).length === 0);\n                if (eventOutsideTarget) {\n                    scope.$apply(function() {\n                        scope.popoverIsOpen = false;\n                    });\n                }\n            };\n\n            $document.on('click', documentClickHandler);\n            scope.$on('$destroy', function() {\n                $document.off('click', documentClickHandler);\n            });\n        }\n    };\n}]);\n","module.controller('AddScopeCtrl',\n    function($scope, $modalInstance, $window) {\n\n        $scope.origin = $window.location.origin;\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close();\n\t\t};\n    }\n);\n","module.controller('BadgeCtrl', function ($scope, $modalInstance, $window, repo) {\n    $scope.claRepo = repo;\n    $scope.badgeUrl = $window.location + 'readme/badge/' + repo.owner + '/' + repo.repo;\n    $scope.linkUrl = $window.location + repo.owner + '/' + repo.repo;\n    $scope.types = [{\n        type: 'HTML',\n        url: '<a href=\"' + $scope.linkUrl + '\"><img src=\"' + $scope.badgeUrl + '\" alt=\"CLA assistant\" /></a>'\n    }, {\n        type: 'Image URL',\n        url: $scope.badgeUrl\n    }, {\n        type: 'Markdown',\n        url: '[![CLA assistant](' + $scope.badgeUrl + ')](' + $scope.linkUrl + ')'\n    }, {\n        type: 'Textile',\n        url: '!' + $scope.badgeUrl + '(CLA assistant)!:' + $scope.linkUrl\n    }, {\n        type: 'RDOC',\n        url: '{<img src=\"' + $scope.badgeUrl + '\" alt=\"CLA assistant\" />}[' + $scope.linkUrl + ']'\n    }];\n\n    $scope.selectedType = {};\n    $scope.selectedType.type = $scope.types[0];\n\n    $scope.cancel = function () {\n        $modalInstance.dismiss('cancel');\n    };\n})\n// copied from https://github.com/sachinchoolur/ngclipboard/blob/master/src/ngclipboard.js\n.directive('ngClipboard', function(){\n    return {\n        restrict: 'A',\n        scope: {\n            ngClipboardSuccess: '&',\n            ngClipboardError: '&'\n        },\n        link: function(scope, element) {\n            var clipboard = new Clipboard(element[0]);\n\n            clipboard.on('success', function(e) {\n                scope.ngClipboardSuccess({\n                    e: e\n                });\n            });\n\n            clipboard.on('error', function(e) {\n                scope.ngClipboardError({\n                    e: e\n                });\n            });\n        }\n    };\n});\n","module.controller('ClaViewCtrl', function($scope, $modalInstance, $window, cla, $state, $RPCService, $sce, utils) {\n\t\t$scope.claObj = cla;\n\t\t$scope.cla = null;\n\t\t$scope.modalInstance = $modalInstance;\n\n\t\t$scope.getGistName = function(gistObj){\n            return utils.getGistAttribute(gistObj, 'filename');\n\t\t};\n\n\t\tfunction getCLA () {\n\t\t\t\treturn $RPCService.call('cla', 'get', {\n\t\t\t\t\t\trepo: $scope.claObj.repo,\n\t\t\t\t\t\towner: $scope.claObj.owner,\n\t\t\t\t\t\tgist: {\n\t\t\t\t\t\t\tgist_url: $scope.claObj.gist_url,\n\t\t\t\t\t\t\tgist_version: $scope.claObj.gist_version\n\t\t\t\t\t\t}\n\t\t\t\t}, function(err, gist) {\n\t\t\t\t\t\tif(!err) {\n\t\t\t\t\t\t\t\t$scope.claText = gist.value.raw;\n\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\tgetCLA().then(function(data){\n\t\t\t$scope.cla = $sce.trustAsHtml(data.value.raw);\n\t\t\t$scope.cla.text = data.value.raw;\n\t\t\t//console.log($scope.cla.text);\n\t\t});\n\n\n    $scope.cancel = function () {\n        $modalInstance.dismiss('cancel');\n    };\n\n})\n.directive('clacontent', [function(){\n    return {\n        link: function(scope, element, attrs){\n\t\t\t\t\t\tscope.$watch(attrs.clacontent, function(content){\n\t\t\t\t\t\t\t\tif (content) {\n\t\t\t\t\t\t\t\t\tvar linkIcons = element[0].getElementsByClassName('octicon octicon-link');\n\t\t\t\t\t\t\t\t\tfor (var index in linkIcons){\n\t\t\t\t\t\t\t\t\t\tif (linkIcons.hasOwnProperty(index)){\n\t\t\t\t\t\t\t\t\t\t\tangular.element(linkIcons[index]).removeClass('octicon octicon-link');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n        }\n    };\n}]);\n","module.controller('ConfirmCtrl',\n\tfunction($scope, $modalInstance, $window, $timeout, selected) {\n\t\t$scope.gist = selected && selected.gist ? selected.gist : null;\n\t\t$scope.item = selected && selected.item ? selected.item : null;\n\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close(selected.item);\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('ErrorCtrl',\n\tfunction($scope, $modalInstance) {\n\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close();\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('InfoCtrl',\n    function($scope, $modalInstance, $window) {\n\n        $scope.origin = $window.location.origin;\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('LinkCtrl',\n    function($scope, $modalInstance) {\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close();\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('ReportCtrl', function($scope, $modalInstance, $window, item) {\n\t$scope.claItem = item;\n\t$scope.newContributors = {loading: false};\n\t$scope.history = $scope.gist.history.concat({text: 'All versions'});\n\t// $scope.gist = null;\n\t$scope.selectedVersion = {};\n\t$scope.selectedVersion.version = $scope.gist.history[0];\n\n\t$scope.cancel = function () {\n\t\t$modalInstance.dismiss('cancel');\n\t};\n});\n","module.controller('UploadCtrl',\n\tfunction($scope, $modalInstance) {\n\n\t\t$scope.json = {};\n\n\t\t$scope.$watch('file', function() {\n\t\t\tif($scope.file) {\n\t\t\t\tPapa.parse($scope.file, {\n\t\t\t\t\tcomplete: function(data) {\n\t\t\t\t\t\t$scope.json = data;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$scope.upload = function(index) {\n\n\t\t\tvar data = [];\n\n\t\t\tfor(var i = ($scope.header ? 1 : 0); i < $scope.json.data.length; i++) {\n\t\t\t\tdata.push($scope.json.data[i][index]);\n\t\t\t}\n\n\t\t\t$modalInstance.close(data);\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n\t}\n)\n.directive('fileModel', function(){\n\treturn {\n\t\tscope: {\n\t\t\tfileModel: '='\n\t\t},\n\t\tlink: function(scope, elem) {\n\t\t\telem.bind('change drop', function(change) {\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\treader.onload = function(load) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\tscope.fileModel = load.target.result;\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\treader.readAsText(change.target.files[0]);\n\t\t\t});\n\n\t\t\telem.bind('ondragenter', function() {\n\t\t\t\tconsole.log('dude...');\n\t\t\t});\n\t\t}\n\t};\n});\n","module.controller('VersionViewCtrl', function($scope, $rootScope, $modalInstance, cla, $location, noCLA, showCLA, $window) {\n  $scope.claObj = cla;\n  $scope.noCLA = noCLA;\n  $scope.showCLA = showCLA;\n  $scope.cla = null;\n  $scope.modalInstance = $modalInstance;\n  $scope.newCLA = null;\n\n  $scope.openNewCla = function () {\n    $modalInstance.dismiss('Link opened');\n    $window.location.href = '/' + $scope.claObj.owner + '/' + $scope.claObj.repo;\n  };\n\n  $scope.openRevision = function () {\n    $window.open($scope.claObj.gist_url + '/revisions');\n  };\n\n   $scope.cancel = function () {\n      $modalInstance.dismiss('cancel');\n  };\n});\n","'use strict';\nvar reservedGistFileNames = ['metadata'];\n\nmodule.factory('utils', ['$q', '$RPCService',\n    function($q, $RPCService) {\n        return {\n            getGistAttribute: function(gist, attribute) {\n                var attr;\n                if (gist && gist.files) {\n                    Object.keys(gist.files).some(function (file) {\n                        if (reservedGistFileNames.indexOf(file) < 0) {\n                            attr = file;\n                            return true;\n                        }\n                    });\n                    attr = gist.files[attr][attribute] ? gist.files[attr][attribute] : attr;\n                }\n                return attr;\n            },\n            getGistContent: function (repoId, orgId, gist_url, gist_version) {\n                var deferred = $q.defer();\n                var gistContent = {};\n                var args = {\n                    repoId: repoId,\n                    orgId: orgId\n                };\n                if (gist_url) {\n                    args.gist = {\n                        gist_url: gist_url,\n                        gist_version: gist_version\n                    };\n                }\n                $RPCService.call('cla', 'get', args, function (err, cla) {\n                    if (!err) {\n                        gistContent.claText = cla.value.raw;\n\n                        if (cla.value.meta) {\n                            try {\n                                var metaString = cla.value.meta.replace(/<p>|<\\/p>|\\n|\\t/g, '');\n                                gistContent.customFields = JSON.parse(metaString);\n                                gistContent.customKeys = Object.keys(gistContent.customFields);\n                                gistContent.hasCustomFields = true;\n                                deferred.resolve(gistContent);\n                            } catch (ex) {\n                                deferred.reject(ex);\n                            }\n                        } else {\n                            deferred.resolve(gistContent);\n                        }\n                    } else {\n                        deferred.reject(err);\n                    }\n                });\n                return deferred.promise;\n            }\n        };\n    }\n]);"]}